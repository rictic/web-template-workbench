{"version":3,"file":"static_test.js","sourceRoot":"","sources":["../../src/test/static_test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport {render} from '../index.js';\nimport {literal, html, unsafeStatic} from '../static.js';\nimport {makeAsserts} from './test-utils/assert-render.js';\nimport {assert} from '@esm-bundle/chai';\n\nsuite('static', () => {\n  let container: HTMLElement;\n\n  const {assertContent} = makeAsserts(() => container);\n\n  setup(() => {\n    container = document.createElement('div');\n  });\n\n  test('static text binding', () => {\n    render(html`${literal`<p>Hello</p>`}`, container);\n    // If this were a dynamic binding, the tags would be escaped\n    assertContent('<p>Hello</p>');\n  });\n\n  test('static attribute binding', () => {\n    render(html`<div class=\"${literal`cool`}\"></div>`, container);\n    assertContent('<div class=\"cool\"></div>');\n    // TODO: test that this is actually static. It's not currently possible with\n    // the public API\n  });\n\n  test('static tag binding', () => {\n    const tagName = literal`div`;\n    render(html`<${tagName}>${'A'}</${tagName}>`, container);\n    assertContent('<div>A</div>');\n  });\n\n  test('static attribute name binding', () => {\n    render(html`<div ${literal`foo`}=\"${'bar'}\"></div>`, container);\n    assertContent('<div foo=\"bar\"></div>');\n\n    render(html`<div x-${literal`foo`}=\"${'bar'}\"></div>`, container);\n    assertContent('<div x-foo=\"bar\"></div>');\n  });\n\n  test('static attribute name binding', () => {\n    render(html`<div ${literal`foo`}=\"${literal`bar`}\"></div>`, container);\n    assertContent('<div foo=\"bar\"></div>');\n  });\n\n  test('dynamic binding after static text binding', () => {\n    render(html`${literal`<p>Hello</p>`}${'<p>World</p>'}`, container);\n    assertContent('<p>Hello</p>&lt;p&gt;World&lt;/p&gt;');\n\n    // Make sure `null` is handled\n    render(html`${literal`<p>Hello</p>`}${null}`, container);\n    assertContent('<p>Hello</p>');\n  });\n\n  test('static bindings are keyed by static values', () => {\n    // A template with a bound tag name. We should be able to re-render\n    // this template with different tag names and have the tag names update.\n    // New tag names will act as different templates.\n    const t = (tag: string, text: string) =>\n      html`<${unsafeStatic(tag)}>${text}</${unsafeStatic(tag)}>`;\n\n    render(t('div', 'abc'), container);\n    assertContent('<div>abc</div>');\n    const div = container.querySelector('div');\n    assert.isNotNull(div);\n\n    render(t('div', 'def'), container);\n    assertContent('<div>def</div>');\n    const div2 = container.querySelector('div');\n    // Static values are stable between renders like static template strings\n    assert.strictEqual(div2, div);\n\n    render(t('span', 'abc'), container);\n    // Rendering with a new static value should work, though it re-renders\n    // since we have a new template.\n    assertContent('<span>abc</span>');\n    const span = container.querySelector('span');\n    assert.isNotNull(span);\n\n    render(t('span', 'def'), container);\n    assertContent('<span>def</span>');\n    const span2 = container.querySelector('span');\n    assert.strictEqual(span2, span);\n\n    render(t('div', 'abc'), container);\n    assertContent('<div>abc</div>');\n    const div3 = container.querySelector('div');\n    // Static values do not have any caching behavior. Re-rendering with a\n    // previously used value does not restore static DOM\n    assert.notStrictEqual(div3, div);\n  });\n\n  test('interpolating statics into statics', () => {\n    const start = literal`<${literal`sp${literal`an`}`}>`;\n    const end = literal`</${unsafeStatic('span')}>`;\n    render(html`<div>a${start}b${end}c</div>`, container);\n    assertContent('<div>a<span>b</span>c</div>');\n  });\n\n  test('interpolating non-statics into statics throws', () => {\n    assert.throws(() => {\n      literal`a${literal`bar`}b${'shouldthrow'}`;\n    });\n  });\n\n  suite('unsafe', () => {\n    test('static tag binding', () => {\n      const tagName = unsafeStatic('div');\n      render(html`<${tagName}>${'A'}</${tagName}>`, container);\n      assertContent('<div>A</div>');\n    });\n\n    test('static attribute name binding', () => {\n      render(html`<div ${unsafeStatic('foo')}=\"${'bar'}\"></div>`, container);\n      assertContent('<div foo=\"bar\"></div>');\n\n      render(html`<div x-${unsafeStatic('foo')}=\"${'bar'}\"></div>`, container);\n      assertContent('<div x-foo=\"bar\"></div>');\n    });\n  });\n\n  test(`don't render simple spoofed static values`, () => {\n    const spoof = {\n      ['_$staticValue$']: 'foo',\n      r: {},\n    };\n    const template = html`<div>${spoof}</div>`;\n    render(template, container);\n    assertContent('<div>[object Object]</div>');\n  });\n\n  test('static html should not add value for consumed static expression', () => {\n    const tagName = literal`div`;\n    const template = html`<${tagName}>${'foo'}</${tagName}>`;\n    assert.equal(template.values.length, 1);\n    const template2 = html`<${tagName}>${'foo'}</${tagName}>${'bar'}`;\n    assert.equal(template2.values.length, 2);\n  });\n});\n"]}