import{getTemplateHtml as t,boundAttributeSuffix as e,marker as r,rawTextElement as s,markerMatch as o}from"./get-template-html.js";import{templateFromLiterals as n}from"./template-from-literals.js";import{SVG_RESULT as c}from"./ttl.js";
/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const i=document,a=()=>i.createComment(""),p=Array.isArray,f=t=>p(t)||"function"==typeof t?.[Symbol.iterator],l=i.createTreeWalker(i,129);class m{constructor({strings:n,_$litType$:p},f){let m;this.parts=[],console.log("creating a manual template");let h=0,d=0;const y=n.length-1,u=this.parts,[g,x]=t(n,p),v=i.createElement("template");if(v.innerHTML=g,this.el=v,l.currentNode=this.el.content,p===c){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(m=l.nextNode())&&u.length<y;){if(1===m.nodeType){if(m.hasAttributes())for(const t of m.getAttributeNames())if(t.endsWith(e)){const e=x[d++],s=m.getAttribute(t).split(r),o=/([.?@])?(.*)/.exec(e);u.push({type:1,index:h,name:o[2],strings:s,ctor:w}),m.removeAttribute(t)}else t.startsWith(r)&&(u.push({type:6,index:h}),m.removeAttribute(t));if(s.test(m.tagName)){const t=m.textContent.split(r),e=t.length-1;if(e>0){m.textContent=window.trustedTypes?window.trustedTypes.emptyScript:"";for(let r=0;r<e;r++)m.append(t[r],a()),l.nextNode(),u.push({type:2,index:++h});m.append(t[e],a())}}}else if(8===m.nodeType)if(m.data===o)u.push({type:2,index:h});else{let t=-1;for(;-1!==(t=m.data.indexOf(r,t+1));)u.push({type:7,index:h}),t+=r.length-1}h++}}}class h{constructor(t){this.parts=[],this.template=t}clone(t){const{el:{content:e},parts:r}=this.template,s=performance.now(),o=(t?.creationScope??i).importNode(e,!0);performance.measure("clone template",{start:s,end:performance.now()});const n=performance.now();performance.measure("get parts",{start:n,end:n});const c=performance.now();performance.measure("adopt",{start:c,end:c});const a=performance.now();l.currentNode=o;let p=l.nextNode(),f=0,m=0,h=r[0];for(;void 0!==h;){if(f===h.index){let e;2===h.type?e=new u(p,p.nextSibling,this,t):1===h.type&&(e=new h.ctor(p,h.name,h.strings)),this.parts.push(e),h=r[++m]}f!==h?.index&&(p=l.nextNode(),f++)}return l.currentNode=i,performance.measure("create part wrappers",{start:a,end:performance.now()}),o}}class d{constructor({strings:t,_$litType$:e},r){if(this.parts=[],console.log("creating a DOM Parts template"),this.el=n(t,e,!0),e===c){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}const s=this.el.content.getPartRoot().getParts();let o=-1;for(const t of s)if(o++,t instanceof NodePart){let e;for(let r=0;r<t.metadata.length;r++){const s=t.metadata[r];"d"===s?(void 0!==e&&(this.parts.push(e),e=void 0),this.parts.push({type:6,index:o})):"attr"===s?(void 0!==e&&this.parts.push(e),e={type:1,index:o,name:t.metadata[++r],ctor:w,strings:[]}):'"'===s[0]&&e.strings.push(JSON.parse(s))}void 0!==e&&this.parts.push(e)}else t instanceof ChildNodePart&&this.parts.push({type:2,index:o})}}class y{constructor(t){this.parts=[],this.template=t}clone(t){const{el:{content:e},parts:r}=this.template,s=performance.now(),o=e.getPartRoot().clone();performance.measure("clone template",{start:s,end:performance.now()});const n=performance.now(),c=o.getParts();performance.measure("get parts",{start:n,end:performance.now()});const i=performance.now(),a=document.adoptNode(o.rootContainer);performance.measure("adopt",{start:i,end:performance.now()});const p=performance.now();for(const e of r){const r=c[e.index];switch(e.type){case 2:this.parts.push(new u(r.previousSibling,r.nextSibling,this,t));break;case 1:this.parts.push(new e.ctor(r.node,e.name,e.strings))}}return performance.measure("create part wrappers",{start:p,end:performance.now()}),a}}class u{constructor(t,e,r,s){this.type=2,this.committedValue="",this.startNode=t,this.endNode=e,this.options=s}}class w{constructor(t,e,r){this.type=1,this.value=[],this.element=t,this.name=e,r.length>2||""!==r[0]||""!==r[1]?(this.value=Array(r.length-1).fill(new String),this.strings=r):this.value=""}}export{w as AttributePart,u as ChildPart,d as DomPartsTemplate,y as DomPartsTemplateInstance,m as ManualTemplate,h as ManualTemplateInstance,f as isIterable};
//# sourceMappingURL=template.js.map
